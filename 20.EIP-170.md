# EIP-170

### 硬分叉

[Spurious Dragon](https://eips.ethereum.org/EIPS/eip-607)

### 参数

- `MAX_CODE_SIZE`：（`0x6000`）`2**14 + 2**13`
- `FORK_BLKNUM`：2,675,000
- `CHAIN_ID`：1（主网）

### 规格

如果`block.number >= FORK_BLKNUM`，那么如果合约创建初始化返回长度**超过** `MAX_CODE_SIZE`字节的数据，合约创建将失败，并出现 gas 不足错误。

### 基本原理

目前，以太坊中仍存在一个轻微的二次漏洞：当调用合约时，即使调用需要恒定量的 gas，调用仍会触发 O(n) 成本，包括从磁盘读取代码、预处理 VM 执行的代码以及将 O(n) 数据添加到 Merkle 证明中以进行块的有效性证明。在当前的 gas 水平下，这是可以接受的，尽管不是最优的。在未来可能触发的更高 gas 水平下，可能很快就会因为动态 gas 限制规则而触发，这将成为一个更大的问题——虽然不像最近的拒绝服务攻击那么严重，但仍然很不方便，尤其是对于未来验证有效性或无效性证明的轻客户端而言。解决方案是对可以保存到区块链的对象的大小设置一个硬性上限，并通过将上限设置为略高于当前 gas 限制可行的值来无中断地执行此操作。

### 









